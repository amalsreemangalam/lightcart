<!DOCTYPE html>
<html lang="en">

<head>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;300;500;900&display=swap" rel="stylesheet"> 
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css">
  <link rel="stylesheet" href="../public/assets/style.css">
  <style>
    .card {
    border: none;
}

.card-body {
    border-bottom: none;
}

.card-title,
.card-subtitle {
    border-bottom: none;
}

.card-header,
.card-footer {
    border: none;
}

    .btn-outline-primary {
      font-size: 10px;
      padding: 5px;
      height: 20px;
      width: 70px;
    }

    .custom-download-btn {
      font-size: 10px;
      padding: 5px;
      height: 30px;
      width: 100px;
    }


    .gradient-custom {
      background: linear-gradient(to top left, #3498db, #8e44ad);
    }

    .btn-outline-primary {
      font-size: 14px;
      padding: 10px;
      height: 40px;
      width: 120px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    .btn-outline-primary:hover {
      background-color: #3498db;
      color: #fff;
    }

    .custom-download-btn {
      font-size: 14px;
      padding: 10px;
      height: 40px;
      width: 150px;
      border-radius: 5px;
      background-color: #27ae60;
      /* Updated color */
      color: #fff;
      transition: background-color 0.3s ease;
    }

    .custom-download-btn:hover {
      background-color: #219d54;
    }
  </style>
</head>

<body>


  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="#">LIGHT CART</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="/cart"><i class="fas fa-shopping-cart"></i> My Cart</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/"><i class="fas fa-user-circle"></i> Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>



  <section class="h-100 gradient-custom">
    <div class="container  py-5">
      <div class="justify-content-center align-items-center">
        <div class="col-lg-12 col-xl-12">
          <div class="card " style=" border-radius: 10px;">
            <div class="card-header px-4 py-5">
              <h5 class="text-muted mb-0">Thanks for your Order, <span style="color: #a8729a;">
                  <%=user.name%>
                </span>!</h5>
            </div>
            <% orderItems.forEach(item=> { %>
              <% item.products.slice().reverse().forEach(prod=> { %>
            <div class="card-body p-4  ">
                  <div class="card mb-4">
                    <div class="row">
                      <div class="col-md-2">
                        <% if (prod.productId.productimage[0]) { %>
                          <img src="<%= prod.productId.productimage[0] %>" class="border rounded me-3"
                            style="width: 96px; height: 96px;" />
                          <% } else { %>
                            <p>No Image Available</p>
                            <% } %>
                      </div>



                      <div class="card shadow-0 mb-4">
                        <div class="card-body">
                          <h6 class="card-title">Order Date</h6>
                          <p><strong>Date:</strong>
                            <%= item.orderDate.toLocaleDateString() %>
                          </p>
                        </div>
                      </div>



                      <div class="col-md-2 text-center d-flex justify-content-center align-items-center" style="margin-bottom: 200px;margin-left: 50px;">
                        <p class="text-muted mb-0 small">
                        <h5>
                          <%= prod.productId.productcategory %>
                            </p>
                        </h5>
                      </div>

                      <div class="col-md-2 text-center d-flex justify-content-center align-items-center"style="margin-bottom: 205px;margin-left: 50px;">
                        <p class="text-muted mb-0 small">Qty: <%= prod.individualquantity %>
                        </p>
                      </div>





                      <div class="card shadow-0 mb-4">
                        <div class="card-body">
                          <h6 class="card-title">Shipping Address</h6>
                          <p><strong>House Name:</strong>
                            <%= item.address[0].houseName %>
                          </p>
                          <p><strong>Street:</strong>
                            <%= item.address[0].street %>
                          </p>
                          <p><strong>City:</strong>
                            <%= item.address[0].city %>
                          </p>
                          <p><strong>State:</strong>
                            <%= item.address[0].state %>
                          </p>
                          <p><strong>Postal Code:</strong>
                            <%= item.address[0].pincode %>
                          </p>
                          <p><strong>Country:</strong>
                            <%= item.address[0].country %>
                          </p>
                        </div>
                      </div>
                      <div class="col text-center d-flex justify-content-center align-items-center" >
                        <p class="text-muted mb-0">
                          ₹<%= prod.individualquantity * (prod.productId.OfferPrice> 0 ? prod.productId.OfferPrice :
                            prod.productId.productprice) %>
                        </p>

                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center align-items-center">
                        <% if (item.status !=='Cancelled' ) { %>
                          <% if (item.status==='Delivered' ) { %>
                            <!-- If status is Delivered, display Return button -->
                            <a href="/returnOrder/<%= item._id %>" class="btn btn-outline-primary">Return</a>
                            <% } else if (item.status==='Returned' ) { %>
                              <!-- If status is Returned, display a message -->
                              <p>Item Returned</p>
                              <% } else { %>
                                <!-- If status is not Cancelled, Delivered, or Returned, display Cancel Order button -->
                                <a href="/cancelOrder/<%= item._id %>/<%= prod.productId._id %>"
                                  class="btn btn-outline-primary">Cancel Order</a>
                                <% } %>
                                  <% } else { %>
                                    <!-- If status is Cancelled, display Cancelled message -->
                                    <p class="text-muted mb-0 small">Cancelled</p>
                                    <% } %>



                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center align-items-center">
                        <a href="/invoiceDownload?orderId=<%= item._id %>&productId=<%= prod.productId._id %>"
                          class="btn btn-outline-primary custom-download-btn">Download Invoice</a>

                      </div>


                    </div>

                      <hr class="mb-4" style="background-color: #e0e0e0; opacity: 1;">
                      <div class="row d-flex align-items-center">
                        <div class="col-md-2">
                          <p class="text-muted mb-0 small">Track Order</p>
                        </div>
                        <div class="col-md-10">


                          <div class="progress" style="height: 6px; border-radius: 16px;">
                            <div class="progress-bar" role="progressbar" style="width: <% 
                  switch (item.status) {
                      case 'Pending':
                          %>0<%
                          break;
                      case 'Order Confirmed':
                          %>25<%
                          break;
                      case 'Shipped':
                          %>50<%
                          break;
                      case 'Out For Delivery':
                          %>75<%
                          break;
                      case 'Delivered':
                          %>100<%
                          break;
                      default:
                          %>0<%
                  }
              %>%; border-radius: 16px; background-color: #a8729a;" aria-valuenow="<% 
                  switch (item.status) {
                      case 'Pending':
                          %>0<%
                          break;
                      case 'Order Confirmed':
                          %>25<%
                          break;
                      case 'Shipped':
                          %>50<%
                          break;
                      case 'Out For Delivery':
                          %>75<%
                          break;
                      case 'Delivered':
                          %>100<%
                          break;
                      default:
                          %>0<%
                  }
              %>" aria-valuemin="0" aria-valuemax="100"></div>
                          </div>


                          <div class="d-flex justify-content-around mb-1">
                            <p class="text-muted mt-1 mb-0 small ms-xl-5"></p>
                            <p class="text-muted mt-1 mb-0 small ms-xl-5">
                              <%=item.status%>
                            </p>
                          </div>
                        </div>
                      </div>
                  </div>
            </div>
            <% }) %>
            <% })%>


          </div>
        </div>
      </div>
    </div>
  </section>
  <div class="d-flex justify-content-center">
    <a href="/" class="btn btn-primary">Continue Shopping</a>
  </div>
  <div style="background-color:gray;">
    <!-- Footer -->
    <!-- Your footer content remains unchanged -->
    <footer class="text-center text-lg-start text-muted bg-gray-300 mt-3">
      <!-- Section: Links  -->
      <section class="">
        <div class="container text-center text-md-start pt-4 pb-4">
          <!-- Grid row -->
          <div class="row mt-3">
            <!-- Grid column -->
            <div class="col-12 col-lg-3 col-sm-12 mb-2">
              <!-- Content -->
              <a href="https://mdbootstrap.com/" target="_blank" class="text-white h2">
                LIGHTCART
              </a>
              <p class="mt-1 text-white">

              </p>
            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-6 col-sm-4 col-lg-2">
              <!-- Links -->
              <h6 class="text-uppercase text-white fw-bold mb-2">
                Store
              </h6>
              <ul class="list-unstyled mb-4">
                <li><a class="text-white-50" href="#">About us</a></li>
                <li><a class="text-white-50" href="#">Find store</a></li>
                <li><a class="text-white-50" href="#">Categories</a></li>
                <li><a class="text-white-50" href="#">Blogs</a></li>
              </ul>
            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-6 col-sm-4 col-lg-2">
              <!-- Links -->
              <h6 class="text-uppercase text-white fw-bold mb-2">
                Information
              </h6>
              <ul class="list-unstyled mb-4">
                <li><a class="text-white-50" href="#">Help center</a></li>
                <li><a class="text-white-50" href="#">Money refund</a></li>
                <li><a class="text-white-50" href="#">Shipping info</a></li>
                <li><a class="text-white-50" href="#">Refunds</a></li>
              </ul>
            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-6 col-sm-4 col-lg-2">
              <!-- Links -->
              <h6 class="text-uppercase text-white fw-bold mb-2">
                Support
              </h6>
              <ul class="list-unstyled mb-4">
                <li><a class="text-white-50" href="#">Help center</a></li>
                <li><a class="text-white-50" href="#">Documents</a></li>
                <li><a class="text-white-50" href="#">Account restore</a></li>
                <li><a class="text-white-50" href="#">My orders</a></li>
              </ul>
            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-12 col-sm-12 col-lg-3">
              <!-- Links -->
              <h6 class="text-uppercase text-white fw-bold mb-2">Newsletter</h6>
              <p class="text-white">Stay in touch with latest updates about our products and offers</p>
              <div class="input-group mb-3">
                <input type="email" class="form-control border" placeholder="Email" aria-label="Email"
                  aria-describedby="button-addon2" />
                <button class="btn btn-light border shadow-0" type="button" id="button-addon2"
                  data-mdb-ripple-color="dark">
                  Join
                </button>
              </div>
            </div>
            <!-- Grid column -->
          </div>
          <!-- Grid row -->
        </div>
      </section>
      <!-- Section: Links  -->

      <div class="">
        <div class="container">
          <div class="d-flex justify-content-between py-4 border-top">
            <!--- payment --->
            <div>
              <i class="fab fa-lg fa-cc-visa text-white"></i>
              <i class="fab fa-lg fa-cc-amex text-white"></i>
              <i class="fab fa-lg fa-cc-mastercard text-white"></i>
              <i class="fab fa-lg fa-cc-paypal text-white"></i>
            </div>
            <!--- payment --->

            <!--- language selector --->
            <div class="dropdown dropup">
              <a class="dropdown-toggle text-white" href="#" id="Dropdown" role="button" data-mdb-toggle="dropdown"
                aria-expanded="false"> <i class="flag-united-kingdom flag m-0 me-1"></i>English </a>

              <ul class="dropdown-menu dropdown-menu-endp" aria-labelledby="Dropdown">
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-united-kingdom flag"></i>English <i
                      class="fa fa-check text-success ms-2"></i></a>
                </li>
                <li>
                  <hr class="dropdown-divider" />
                </li>
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-poland flag"></i>Polski</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-china flag"></i>中文</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-japan flag"></i>日本語</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-germany flag"></i>Deutsch</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-france flag"></i>Français</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-spain flag"></i>Español</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-russia flag"></i>Русский</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#"><i class="flag-portugal flag"></i>Português</a>
                </li>
              </ul>
            </div>

          </div>
        </div>
      </div>
    </footer>
  </div>



</body>

</html>